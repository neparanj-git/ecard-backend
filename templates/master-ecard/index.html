<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Open Graph -->
  <meta property="og:image" content="OGsnap.jpg" />
  <meta property="og:title" id="ogTitle" />
  <meta property="og:description" id="ogDesc" />

  <title id="pageTitle"></title>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  <link href="css/style.css" rel="stylesheet">
  <link rel="stylesheet" href="animate.css">
  <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
</head>

<body>

<div class="container">
  <div class="row justify-content-md-center g-0">
    <div class="col col-lg-4 col-md-12 col-sm-12 text-center ecard">

      <!-- Carousel -->
      <div id="demo" class="carousel slide" data-bs-ride="carousel">
        <div class="carousel-inner">
          <div class="carousel-item active">
            <img src="images/s1.webp" class="d-block w-100">
          </div>
          <div class="carousel-item">
            <img src="images/s2.webp" class="d-block w-100">
          </div>
        </div>
      </div>

      <!-- Logo -->
      <div class="profile_img_div">
        <img src="images/LOGO.jpg" class="profile_img shadow" />
      </div>

      <!-- Profile -->
      <div class="profile_info">
        <h4 class="name" id="fullName"></h4>
        <p id="tagline"></p>
      </div>

      <!-- Contact Buttons -->
      <div class="row justify-content-md-center g-0">
        <div class="col-4 contact_info">
          <a href="javascript:void(0)" id="whatsappBtn" class="green">
            <i class="fa fa-whatsapp fa-2x"></i><br>Whatsapp
          </a>
        </div>

        <div class="col-4 contact_info">
          <a id="callBtn" class="skyblue">
            <i class="fa fa-phone fa-2x"></i><br>Call
          </a>
        </div>

        <div class="col-4 contact_info">
          <a id="vcfBtn" class="pink">
            <i class="fa fa-address-book fa-2x"></i><br>Add Contact
          </a>
        </div>
      </div>

      <!-- Tabs -->
      <div class="tab-div">
        <ul class="nav nav-tabs justify-content-center mb-3">
          <li class="nav-item">
            <a class="nav-link active" data-bs-toggle="tab" href="#servicesTab">Services</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-bs-toggle="tab" href="#aboutTab">About</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-bs-toggle="tab" href="#testimonialsTab">Testimonials</a>
          </li>
        </ul>

        <div class="tab-content">
          <div class="tab-pane fade show active" id="servicesTab"></div>
          <div class="tab-pane fade" id="aboutTab"></div>
          <div class="tab-pane fade" id="testimonialsTab"></div>
        </div>
      </div>

      <!-- Share -->
      <div class="m-2">
        <div class="input-group mb-3">
          <input type="text" id="personNo" class="form-control" placeholder="Enter Mobile Number">
          <span class="input-group-text" id="shareMe">Share</span>
        </div>
      </div>

      <!-- Social Media -->
      <div class="social_media" id="socials"></div>

      <p class="footer-text">
        Designed & Developed by <a id="websiteLink" target="_blank"></a>
      </p>

    </div>
  </div>
</div>

<script>
  /* ===============================
     CARD DATA (INJECTED BY BACKEND)
  =============================== */
  const CARD = __CARD_DATA__;

  /* ===============================
     BASIC INFO
  =============================== */
  const setText = (id, value) => {
    const el = document.getElementById(id);
    if (!el) return;
    if (!value) el.style.display = "none";
    else el.textContent = value;
  };

  setText("fullName", CARD.fullName);
  setText("tagline", CARD.tagline);

  document.title = CARD.fullName || "";
  document.getElementById("ogTitle").content = CARD.fullName || "";
  document.getElementById("ogDesc").content = CARD.tagline || "";

  /* ===============================
     CONTACT BUTTONS
  =============================== */

  // CALL
  if (Array.isArray(CARD.phones) && CARD.phones[0]) {
    document.getElementById("callBtn").href = "tel:" + CARD.phones[0];
  } else {
    document.getElementById("callBtn").style.display = "none";
  }

  // ADD CONTACT
  document.getElementById("vcfBtn").href = "template.vcf";

  /* ===============================
     BUILD WHATSAPP MESSAGE
  =============================== */
  function buildWhatsappMessage() {
    const msg = CARD.shareMessage || "";
    const slug = CARD.slug || "";

    const link = slug
      ? "https://e-bizcard.in/" + slug + "/"
      : "";

    let finalMsg = "";

    if (msg) finalMsg += msg + "\n\n";
    if (link) finalMsg += link + "\n\n";
    finalMsg += "Send Hi to activate the link";

    return finalMsg.trim();
  }

  // WHATSAPP ICON
  if (Array.isArray(CARD.whatsapps) && CARD.whatsapps[0]) {
    document.getElementById("whatsappBtn").onclick = function () {
      window.open(
        "https://api.whatsapp.com/send?phone=" +
          CARD.whatsapps[0] +
          "&text=" +
          encodeURIComponent(buildWhatsappMessage()),
        "_blank"
      );
    };
  } else {
    document.getElementById("whatsappBtn").style.display = "none";
  }

  /* ===============================
     SHARE BUTTON
  =============================== */
  document.getElementById("shareMe").onclick = function () {
    const no = document.getElementById("personNo").value;
    if (!no) return alert("Please enter a mobile number");

    window.open(
      "https://api.whatsapp.com/send?phone=91" + no +
        "&text=" + encodeURIComponent(buildWhatsappMessage()),
      "_blank"
    );
  };

  /* ===============================
     SERVICES
  =============================== */
  const servicesTab = document.getElementById("servicesTab");
  if (Array.isArray(CARD.services) && CARD.services.length) {
    servicesTab.innerHTML = CARD.services
      .filter(s => s.title || s.description)
      .map(s => `
        <div class="mb-2">
          <strong>${s.title || ""}</strong>
          <p>${s.description || ""}</p>
        </div>
      `).join("");
  } else {
    servicesTab.style.display = "none";
  }

  /* ===============================
     ABOUT
  =============================== */
  const aboutTab = document.getElementById("aboutTab");
  if (CARD.about) {
    aboutTab.innerHTML = CARD.about;
  } else {
    aboutTab.style.display = "none";
  }

  /* ===============================
     TESTIMONIALS
  =============================== */
  const testimonialsTab = document.getElementById("testimonialsTab");
  if (Array.isArray(CARD.testimonials) && CARD.testimonials.length) {
    testimonialsTab.innerHTML = CARD.testimonials
      .filter(t => t.name || t.message)
      .map(t => `
        <div class="mb-2">
          <strong>${t.name || ""}</strong>
          <p>${t.message || ""}</p>
        </div>
      `).join("");
  } else {
    testimonialsTab.style.display = "none";
  }

  /* ===============================
     SOCIAL LINKS
  =============================== */
  const socialDiv = document.getElementById("socials");
  const socials = [
    ["emails", "fa-envelope", "mailto:"],
    ["instagram", "fa-instagram", ""],
    ["facebook", "fa-facebook", ""],
    ["youtube", "fa-youtube-play", ""],
    ["linkedin", "fa-linkedin", ""],
    ["twitter", "fa-twitter", ""],
    ["maps", "fa-google", ""]
  ];

  socials.forEach(([key, icon, prefix]) => {
    if (Array.isArray(CARD[key]) && CARD[key][0]) {
      const a = document.createElement("a");
      a.href = prefix + CARD[key][0];
      a.target = "_blank";
      a.innerHTML = `<i class="fa ${icon} fa-2x"></i>`;
      socialDiv.appendChild(a);
    }
  });
</script>

</body>
</html>
